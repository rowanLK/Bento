<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>managers/asset.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
    <link type="text/css" rel="stylesheet" href="styles/bento.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><details><summary>bento</summary><a href="module-bento.html">bento</a><ul class='methods'><li data-type='method'><a href="module-bento.html#createCanvas">createCanvas</a></li><li data-type='method'><a href="module-bento.html#getAntiAlias">getAntiAlias</a></li><li data-type='method'><a href="module-bento.html#getCanvas">getCanvas</a></li><li data-type='method'><a href="module-bento.html#getGameData">getGameData</a></li><li data-type='method'><a href="module-bento.html#getGameSpeed">getGameSpeed</a></li><li data-type='method'><a href="module-bento.html#getRenderer">getRenderer</a></li><li data-type='method'><a href="module-bento.html#getSettings">getSettings</a></li><li data-type='method'><a href="module-bento.html#getViewport">getViewport</a></li><li data-type='method'><a href="module-bento.html#isDev">isDev</a></li><li data-type='method'><a href="module-bento.html#reload">reload</a></li><li data-type='method'><a href="module-bento.html#setAntiAlias">setAntiAlias</a></li><li data-type='method'><a href="module-bento.html#setGameSpeed">setGameSpeed</a></li><li data-type='method'><a href="module-bento.html#setup">setup</a></li></ul></details></li><li><details><summary>bento/autoresize</summary><a href="module-bento_autoresize.html">bento/autoresize</a></details></li><li><details><summary>bento/canvas</summary><a href="module-bento_canvas.html">bento/canvas</a><ul class='methods'><li data-type='method'><a href="module-bento_canvas.html#downloadImage">downloadImage</a></li><li data-type='method'><a href="module-bento_canvas.html#drawOnce">drawOnce</a></li><li data-type='method'><a href="module-bento_canvas.html#getBase64">getBase64</a></li><li data-type='method'><a href="module-bento_canvas.html#getCanvas">getCanvas</a></li><li data-type='method'><a href="module-bento_canvas.html#getContext">getContext</a></li></ul></details></li><li><details><summary>bento/components/clickable</summary><a href="module-bento_components_clickable.html">bento/components/clickable</a><ul class='methods'><li data-type='method'><a href="module-bento_components_clickable.html#isPaused">isPaused</a></li></ul></details></li><li><details><summary>bento/components/eventlistener</summary><a href="module-bento_components_eventlistener.html">bento/components/eventlistener</a></details></li><li><details><summary>bento/components/fill</summary><a href="module-bento_components_fill.html">bento/components/fill</a><ul class='methods'><li data-type='method'><a href="module-bento_components_fill.html#setOriginRelative">setOriginRelative</a></li></ul></details></li><li><details><summary>bento/components/modal</summary><a href="module-bento_components_modal.html">bento/components/modal</a></details></li><li><details><summary>bento/components/nineslice</summary><a href="module-bento_components_nineslice.html">bento/components/nineslice</a><ul class='methods'><li data-type='method'><a href="module-bento_components_nineslice.html#setOriginRelative">setOriginRelative</a></li></ul></details></li><li><details><summary>bento/components/pixi/sprite</summary><a href="module-bento_components_pixi_sprite.html">bento/components/pixi/sprite</a></details></li><li><details><summary>bento/components/spine</summary><a href="module-bento_components_spine.html">bento/components/spine</a><ul class='methods'><li data-type='method'><a href="module-bento_components_spine.html#getAnimation">getAnimation</a></li><li data-type='method'><a href="module-bento_components_spine.html#getCurrentSpeed">getCurrentSpeed</a></li><li data-type='method'><a href="module-bento_components_spine.html#getSpineData">getSpineData</a></li><li data-type='method'><a href="module-bento_components_spine.html#setAnimation">setAnimation</a></li><li data-type='method'><a href="module-bento_components_spine.html#setCurrentSpeed">setCurrentSpeed</a></li></ul></details></li><li><details><summary>bento/components/sprite</summary><a href="module-bento_components_sprite.html">bento/components/sprite</a><ul class='methods'><li data-type='method'><a href="module-bento_components_sprite.html#getAnimationName">getAnimationName</a></li><li data-type='method'><a href="module-bento_components_sprite.html#getCurrentFrame">getCurrentFrame</a></li><li data-type='method'><a href="module-bento_components_sprite.html#getCurrentSpeed">getCurrentSpeed</a></li><li data-type='method'><a href="module-bento_components_sprite.html#getFrameHeight">getFrameHeight</a></li><li data-type='method'><a href="module-bento_components_sprite.html#getFrameWidth">getFrameWidth</a></li><li data-type='method'><a href="module-bento_components_sprite.html#setAnimation">setAnimation</a></li><li data-type='method'><a href="module-bento_components_sprite.html#setAnimation">setAnimation</a></li><li data-type='method'><a href="module-bento_components_sprite.html#setCurrentSpeed">setCurrentSpeed</a></li><li data-type='method'><a href="module-bento_components_sprite.html#setFrame">setFrame</a></li><li data-type='method'><a href="module-bento_components_sprite.html#setOriginRelative">setOriginRelative</a></li><li data-type='method'><a href="module-bento_components_sprite.html#setup">setup</a></li></ul></details></li><li><details><summary>bento/entity</summary><a href="module-bento_entity.html">bento/entity</a><ul class='methods'><li data-type='method'><a href="module-bento_entity.html#attach">attach</a></li><li data-type='method'><a href="module-bento_entity.html#collidesWith">collidesWith</a></li><li data-type='method'><a href="module-bento_entity.html#extend">extend</a></li><li data-type='method'><a href="module-bento_entity.html#getBoundingBox">getBoundingBox</a></li><li data-type='method'><a href="module-bento_entity.html#getComponent">getComponent</a></li><li data-type='method'><a href="module-bento_entity.html#getWorldPosition">getWorldPosition</a></li><li data-type='method'><a href="module-bento_entity.html#moveComponentTo">moveComponentTo</a></li><li data-type='method'><a href="module-bento_entity.html#remove">remove</a></li><li data-type='method'><a href="module-bento_entity.html#removeByName">removeByName</a></li><li data-type='method'><a href="module-bento_entity.html#removeSelf">removeSelf</a></li><li data-type='method'><a href="module-bento_entity.html#toComparablePosition">toComparablePosition</a></li><li data-type='method'><a href="module-bento_entity.html#toLocalPosition">toLocalPosition</a></li><li data-type='method'><a href="module-bento_entity.html#toWorldPosition">toWorldPosition</a></li></ul></details></li><li><details><summary>bento/eventsystem</summary><a href="module-bento_eventsystem.html">bento/eventsystem</a><ul class='methods'><li data-type='method'><a href="module-bento_eventsystem.html#clear">clear</a></li><li data-type='method'><a href="module-bento_eventsystem.html#fire">fire</a></li><li data-type='method'><a href="module-bento_eventsystem.html#off">off</a></li><li data-type='method'><a href="module-bento_eventsystem.html#on">on</a></li><li data-type='method'><a href="module-bento_eventsystem.html#stopPropagation">stopPropagation</a></li></ul></details></li><li><details><summary>bento/gui/centeredlist</summary><a href="module-bento_gui_centeredlist.html">bento/gui/centeredlist</a><ul class='methods'><li data-type='method'><a href="module-bento_gui_centeredlist.html#clear">clear</a></li><li data-type='method'><a href="module-bento_gui_centeredlist.html#get">get</a></li><li data-type='method'><a href="module-bento_gui_centeredlist.html#getIndex">getIndex</a></li><li data-type='method'><a href="module-bento_gui_centeredlist.html#iterate">iterate</a></li><li data-type='method'><a href="module-bento_gui_centeredlist.html#length">length</a></li><li data-type='method'><a href="module-bento_gui_centeredlist.html#removeItem">removeItem</a></li></ul></details></li><li><details><summary>bento/gui/clickbutton</summary><a href="module-bento_gui_clickbutton.html">bento/gui/clickbutton</a><ul class='methods'><li data-type='method'><a href="module-bento_gui_clickbutton.html#active">active</a></li><li data-type='method'><a href="module-bento_gui_clickbutton.html#doCallback">doCallback</a></li><li data-type='method'><a href="module-bento_gui_clickbutton.html#isActive">isActive</a></li><li data-type='method'><a href="module-bento_gui_clickbutton.html#mimicClick">mimicClick</a></li><li data-type='method'><a href="module-bento_gui_clickbutton.html#setActive">setActive</a></li><li data-type='method'><a href="module-bento_gui_clickbutton.html#setNineSliceSize">setNineSliceSize</a></li></ul></details></li><li><details><summary>bento/gui/counter</summary><a href="module-bento_gui_counter.html">bento/gui/counter</a></details></li><li><details><summary>bento/gui/scrollinglist</summary><a href="module-bento_gui_scrollinglist.html">bento/gui/scrollinglist</a><ul class='methods'><li data-type='method'><a href="module-bento_gui_scrollinglist.html#active">active</a></li><li data-type='method'><a href="module-bento_gui_scrollinglist.html#addItem">addItem</a></li><li data-type='method'><a href="module-bento_gui_scrollinglist.html#cancel">cancel</a></li><li data-type='method'><a href="module-bento_gui_scrollinglist.html#didMove">didMove</a></li><li data-type='method'><a href="module-bento_gui_scrollinglist.html#forceTo">forceTo</a></li><li data-type='method'><a href="module-bento_gui_scrollinglist.html#get">get</a></li><li data-type='method'><a href="module-bento_gui_scrollinglist.html#getItems">getItems</a></li><li data-type='method'><a href="module-bento_gui_scrollinglist.html#getScroll">getScroll</a></li><li data-type='method'><a href="module-bento_gui_scrollinglist.html#getSelection">getSelection</a></li><li data-type='method'><a href="module-bento_gui_scrollinglist.html#getTotalSize">getTotalSize</a></li><li data-type='method'><a href="module-bento_gui_scrollinglist.html#isScrolling">isScrolling</a></li><li data-type='method'><a href="module-bento_gui_scrollinglist.html#iterate">iterate</a></li><li data-type='method'><a href="module-bento_gui_scrollinglist.html#length">length</a></li><li data-type='method'><a href="module-bento_gui_scrollinglist.html#removeItem">removeItem</a></li><li data-type='method'><a href="module-bento_gui_scrollinglist.html#setActive">setActive</a></li><li data-type='method'><a href="module-bento_gui_scrollinglist.html#setArea">setArea</a></li><li data-type='method'><a href="module-bento_gui_scrollinglist.html#setMaxOffset">setMaxOffset</a></li><li data-type='method'><a href="module-bento_gui_scrollinglist.html#setMinOffset">setMinOffset</a></li><li data-type='method'><a href="module-bento_gui_scrollinglist.html#setSpacing">setSpacing</a></li><li data-type='method'><a href="module-bento_gui_scrollinglist.html#snapTo">snapTo</a></li><li data-type='method'><a href="module-bento_gui_scrollinglist.html#stopSliding">stopSliding</a></li></ul></details></li><li><details><summary>bento/gui/text</summary><a href="module-bento_gui_text.html">bento/gui/text</a><ul class='methods'><li data-type='method'><a href="module-bento_gui_text.html#getCanvas">getCanvas</a></li><li data-type='method'><a href="module-bento_gui_text.html#getEffectiveFontSize">getEffectiveFontSize</a></li><li data-type='method'><a href="module-bento_gui_text.html#getStrings">getStrings</a></li><li data-type='method'><a href="module-bento_gui_text.html#getText">getText</a></li><li data-type='method'><a href="module-bento_gui_text.html#setText">setText</a></li></ul></details></li><li><details><summary>bento/gui/togglebutton</summary><a href="module-bento_gui_togglebutton.html">bento/gui/togglebutton</a><ul class='methods'><li data-type='method'><a href="module-bento_gui_togglebutton.html#doCallback">doCallback</a></li><li data-type='method'><a href="module-bento_gui_togglebutton.html#isActive">isActive</a></li><li data-type='method'><a href="module-bento_gui_togglebutton.html#isToggled">isToggled</a></li><li data-type='method'><a href="module-bento_gui_togglebutton.html#mimicClick">mimicClick</a></li><li data-type='method'><a href="module-bento_gui_togglebutton.html#setActive">setActive</a></li><li data-type='method'><a href="module-bento_gui_togglebutton.html#toggle">toggle</a></li></ul></details></li><li><details><summary>bento/managers/asset</summary><a href="module-bento_managers_asset.html">bento/managers/asset</a><ul class='methods'><li data-type='method'><a href="module-bento_managers_asset.html#getAssetGroups">getAssetGroups</a></li><li data-type='method'><a href="module-bento_managers_asset.html#getAssets">getAssets</a></li><li data-type='method'><a href="module-bento_managers_asset.html#getAudio">getAudio</a></li><li data-type='method'><a href="module-bento_managers_asset.html#getImage">getImage</a></li><li data-type='method'><a href="module-bento_managers_asset.html#getImageElement">getImageElement</a></li><li data-type='method'><a href="module-bento_managers_asset.html#getJson">getJson</a></li><li data-type='method'><a href="module-bento_managers_asset.html#getSpine">getSpine</a></li><li data-type='method'><a href="module-bento_managers_asset.html#getSpriteSheet">getSpriteSheet</a></li><li data-type='method'><a href="module-bento_managers_asset.html#hasAsset">hasAsset</a></li><li data-type='method'><a href="module-bento_managers_asset.html#load">load</a></li><li data-type='method'><a href="module-bento_managers_asset.html#loadAssetGroups">loadAssetGroups</a></li><li data-type='method'><a href="module-bento_managers_asset.html#loadAssetsJson">loadAssetsJson</a></li><li data-type='method'><a href="module-bento_managers_asset.html#loadAudioFromUrl">loadAudioFromUrl</a></li><li data-type='method'><a href="module-bento_managers_asset.html#loadImageFromUrl">loadImageFromUrl</a></li><li data-type='method'><a href="module-bento_managers_asset.html#loadJsonFromUrl">loadJsonFromUrl</a></li><li data-type='method'><a href="module-bento_managers_asset.html#reload">reload</a></li><li data-type='method'><a href="module-bento_managers_asset.html#reload">reload</a></li><li data-type='method'><a href="module-bento_managers_asset.html#unload">unload</a></li></ul></details></li><li><details><summary>bento/managers/audio</summary><a href="module-bento_managers_audio.html">bento/managers/audio</a><ul class='methods'><li data-type='method'><a href="module-bento_managers_audio.html#getVolume">getVolume</a></li><li data-type='method'><a href="module-bento_managers_audio.html#isPlayingMusic">isPlayingMusic</a></li><li data-type='method'><a href="module-bento_managers_audio.html#muteMusic">muteMusic</a></li><li data-type='method'><a href="module-bento_managers_audio.html#muteSound">muteSound</a></li><li data-type='method'><a href="module-bento_managers_audio.html#playMusic">playMusic</a></li><li data-type='method'><a href="module-bento_managers_audio.html#playSound">playSound</a></li><li data-type='method'><a href="module-bento_managers_audio.html#preventSounds">preventSounds</a></li><li data-type='method'><a href="module-bento_managers_audio.html#setVolume">setVolume</a></li><li data-type='method'><a href="module-bento_managers_audio.html#stopAllMusic">stopAllMusic</a></li><li data-type='method'><a href="module-bento_managers_audio.html#stopAllSound">stopAllSound</a></li><li data-type='method'><a href="module-bento_managers_audio.html#stopMusic">stopMusic</a></li><li data-type='method'><a href="module-bento_managers_audio.html#stopSound">stopSound</a></li></ul></details></li><li><details><summary>bento/managers/input</summary><a href="module-bento_managers_input.html">bento/managers/input</a><ul class='methods'><li data-type='method'><a href="module-bento_managers_input.html#getGamepadAxesLeft">getGamepadAxesLeft</a></li><li data-type='method'><a href="module-bento_managers_input.html#getGamepadAxesRight">getGamepadAxesRight</a></li><li data-type='method'><a href="module-bento_managers_input.html#getPointers">getPointers</a></li><li data-type='method'><a href="module-bento_managers_input.html#getRemoteAxes">getRemoteAxes</a></li><li data-type='method'><a href="module-bento_managers_input.html#isAnyGamepadButtonDown">isAnyGamepadButtonDown</a></li><li data-type='method'><a href="module-bento_managers_input.html#isAnyKeyDown">isAnyKeyDown</a></li><li data-type='method'><a href="module-bento_managers_input.html#isGamepadButtonDown">isGamepadButtonDown</a></li><li data-type='method'><a href="module-bento_managers_input.html#isGamepadButtonDown">isGamepadButtonDown</a></li><li data-type='method'><a href="module-bento_managers_input.html#isKeyDown">isKeyDown</a></li><li data-type='method'><a href="module-bento_managers_input.html#isRemoteButtonDown">isRemoteButtonDown</a></li><li data-type='method'><a href="module-bento_managers_input.html#resetPointers">resetPointers</a></li><li data-type='method'><a href="module-bento_managers_input.html#resume">resume</a></li><li data-type='method'><a href="module-bento_managers_input.html#setOffset">setOffset</a></li><li data-type='method'><a href="module-bento_managers_input.html#setRemoteExitOnMenuPress">setRemoteExitOnMenuPress</a></li><li data-type='method'><a href="module-bento_managers_input.html#stop">stop</a></li><li data-type='method'><a href="module-bento_managers_input.html#updateCanvas">updateCanvas</a></li></ul></details></li><li><details><summary>bento/managers/object</summary><a href="module-bento_managers_object.html">bento/managers/object</a><ul class='methods'><li data-type='method'><a href="module-bento_managers_object.html#attach">attach</a></li><li data-type='method'><a href="module-bento_managers_object.html#count">count</a></li><li data-type='method'><a href="module-bento_managers_object.html#draw">draw</a></li><li data-type='method'><a href="module-bento_managers_object.html#get">get</a></li><li data-type='method'><a href="module-bento_managers_object.html#getByFamily">getByFamily</a></li><li data-type='method'><a href="module-bento_managers_object.html#getByName">getByName</a></li><li data-type='method'><a href="module-bento_managers_object.html#getObjects">getObjects</a></li><li data-type='method'><a href="module-bento_managers_object.html#isPaused">isPaused</a></li><li data-type='method'><a href="module-bento_managers_object.html#pause">pause</a></li><li data-type='method'><a href="module-bento_managers_object.html#remove">remove</a></li><li data-type='method'><a href="module-bento_managers_object.html#removeAll">removeAll</a></li><li data-type='method'><a href="module-bento_managers_object.html#resume">resume</a></li><li data-type='method'><a href="module-bento_managers_object.html#run">run</a></li><li data-type='method'><a href="module-bento_managers_object.html#setSortMode">setSortMode</a></li><li data-type='method'><a href="module-bento_managers_object.html#stop">stop</a></li><li data-type='method'><a href="module-bento_managers_object.html#update">update</a></li></ul></details></li><li><details><summary>bento/managers/savestate</summary><a href="module-bento_managers_savestate.html">bento/managers/savestate</a><ul class='methods'><li data-type='method'><a href="module-bento_managers_savestate.html#add">add</a></li><li data-type='method'><a href="module-bento_managers_savestate.html#clear">clear</a></li><li data-type='method'><a href="module-bento_managers_savestate.html#getId">getId</a></li><li data-type='method'><a href="module-bento_managers_savestate.html#getKeys">getKeys</a></li><li data-type='method'><a href="module-bento_managers_savestate.html#getStorage">getStorage</a></li><li data-type='method'><a href="module-bento_managers_savestate.html#isEmpty">isEmpty</a></li><li data-type='method'><a href="module-bento_managers_savestate.html#load">load</a></li><li data-type='method'><a href="module-bento_managers_savestate.html#remove">remove</a></li><li data-type='method'><a href="module-bento_managers_savestate.html#save">save</a></li><li data-type='method'><a href="module-bento_managers_savestate.html#setId">setId</a></li><li data-type='method'><a href="module-bento_managers_savestate.html#setStorage">setStorage</a></li></ul></details></li><li><details><summary>bento/managers/screen</summary><a href="module-bento_managers_screen.html">bento/managers/screen</a><ul class='methods'><li data-type='method'><a href="module-bento_managers_screen.html#add">add</a></li><li data-type='method'><a href="module-bento_managers_screen.html#getCurrentScreen">getCurrentScreen</a></li><li data-type='method'><a href="module-bento_managers_screen.html#hide">hide</a></li><li data-type='method'><a href="module-bento_managers_screen.html#reset">reset</a></li><li data-type='method'><a href="module-bento_managers_screen.html#show">show</a></li></ul></details></li><li><details><summary>bento/math/array2d</summary><a href="module-bento_math_array2d.html">bento/math/array2d</a><ul class='methods'><li data-type='method'><a href="module-bento_math_array2d.html#get">get</a></li><li data-type='method'><a href="module-bento_math_array2d.html#isArray2d">isArray2d</a></li><li data-type='method'><a href="module-bento_math_array2d.html#iterate">iterate</a></li><li data-type='method'><a href="module-bento_math_array2d.html#set">set</a></li></ul></details></li><li><details><summary>bento/math/polygon</summary><a href="module-bento_math_polygon.html">bento/math/polygon</a><ul class='methods'><li data-type='method'><a href="module-bento_math_polygon.html#clone">clone</a></li><li data-type='method'><a href="module-bento_math_polygon.html#getBoundingBox">getBoundingBox</a></li><li data-type='method'><a href="module-bento_math_polygon.html#hasPosition">hasPosition</a></li><li data-type='method'><a href="module-bento_math_polygon.html#intersect">intersect</a></li><li data-type='method'><a href="module-bento_math_polygon.html#isPolygon">isPolygon</a></li><li data-type='method'><a href="module-bento_math_polygon.html#offset">offset</a></li></ul></details></li><li><details><summary>bento/math/rectangle</summary><a href="module-bento_math_rectangle.html">bento/math/rectangle</a><ul class='methods'><li data-type='method'><a href="module-bento_math_rectangle.html#.copyInto">copyInto</a></li><li data-type='method'><a href="module-bento_math_rectangle.html#clone">clone</a></li><li data-type='method'><a href="module-bento_math_rectangle.html#copyInto">copyInto</a></li><li data-type='method'><a href="module-bento_math_rectangle.html#getCenter">getCenter</a></li><li data-type='method'><a href="module-bento_math_rectangle.html#getCorner">getCorner</a></li><li data-type='method'><a href="module-bento_math_rectangle.html#getExtents">getExtents</a></li><li data-type='method'><a href="module-bento_math_rectangle.html#getSize">getSize</a></li><li data-type='method'><a href="module-bento_math_rectangle.html#getX2">getX2</a></li><li data-type='method'><a href="module-bento_math_rectangle.html#getY2">getY2</a></li><li data-type='method'><a href="module-bento_math_rectangle.html#grow">grow</a></li><li data-type='method'><a href="module-bento_math_rectangle.html#hasPosition">hasPosition</a></li><li data-type='method'><a href="module-bento_math_rectangle.html#intersect">intersect</a></li><li data-type='method'><a href="module-bento_math_rectangle.html#intersection">intersection</a></li><li data-type='method'><a href="module-bento_math_rectangle.html#intersectsCircle">intersectsCircle</a></li><li data-type='method'><a href="module-bento_math_rectangle.html#intersectsLine">intersectsLine</a></li><li data-type='method'><a href="module-bento_math_rectangle.html#isRectangle">isRectangle</a></li><li data-type='method'><a href="module-bento_math_rectangle.html#offset">offset</a></li><li data-type='method'><a href="module-bento_math_rectangle.html#union">union</a></li></ul></details></li><li><details><summary>bento/math/transformmatrix</summary><a href="module-bento_math_transformmatrix.html">bento/math/transformmatrix</a><ul class='methods'><li data-type='method'><a href="module-bento_math_transformmatrix.html#clone">clone</a></li><li data-type='method'><a href="module-bento_math_transformmatrix.html#copyInto">copyInto</a></li><li data-type='method'><a href="module-bento_math_transformmatrix.html#multiply">multiply</a></li><li data-type='method'><a href="module-bento_math_transformmatrix.html#multiplyWith">multiplyWith</a></li><li data-type='method'><a href="module-bento_math_transformmatrix.html#multiplyWithVector">multiplyWithVector</a></li><li data-type='method'><a href="module-bento_math_transformmatrix.html#prepend">prepend</a></li><li data-type='method'><a href="module-bento_math_transformmatrix.html#reset">reset</a></li><li data-type='method'><a href="module-bento_math_transformmatrix.html#rotate">rotate</a></li><li data-type='method'><a href="module-bento_math_transformmatrix.html#scale">scale</a></li><li data-type='method'><a href="module-bento_math_transformmatrix.html#translate">translate</a></li></ul></details></li><li><details><summary>bento/math/vector2</summary><a href="module-bento_math_vector2.html">bento/math/vector2</a><ul class='methods'><li data-type='method'><a href="module-bento_math_vector2.html#add">add</a></li><li data-type='method'><a href="module-bento_math_vector2.html#addTo">addTo</a></li><li data-type='method'><a href="module-bento_math_vector2.html#angle">angle</a></li><li data-type='method'><a href="module-bento_math_vector2.html#angleBetween">angleBetween</a></li><li data-type='method'><a href="module-bento_math_vector2.html#clone">clone</a></li><li data-type='method'><a href="module-bento_math_vector2.html#copyInto">copyInto</a></li><li data-type='method'><a href="module-bento_math_vector2.html#distance">distance</a></li><li data-type='method'><a href="module-bento_math_vector2.html#divide">divide</a></li><li data-type='method'><a href="module-bento_math_vector2.html#divideBy">divideBy</a></li><li data-type='method'><a href="module-bento_math_vector2.html#dotProduct">dotProduct</a></li><li data-type='method'><a href="module-bento_math_vector2.html#isCloserThan">isCloserThan</a></li><li data-type='method'><a href="module-bento_math_vector2.html#isFartherThan">isFartherThan</a></li><li data-type='method'><a href="module-bento_math_vector2.html#magnitude">magnitude</a></li><li data-type='method'><a href="module-bento_math_vector2.html#multiply">multiply</a></li><li data-type='method'><a href="module-bento_math_vector2.html#multiplyWith">multiplyWith</a></li><li data-type='method'><a href="module-bento_math_vector2.html#normalize">normalize</a></li><li data-type='method'><a href="module-bento_math_vector2.html#reflect">reflect</a></li><li data-type='method'><a href="module-bento_math_vector2.html#rotateDegree">rotateDegree</a></li><li data-type='method'><a href="module-bento_math_vector2.html#rotateRadian">rotateRadian</a></li><li data-type='method'><a href="module-bento_math_vector2.html#scalarMultiply">scalarMultiply</a></li><li data-type='method'><a href="module-bento_math_vector2.html#scalarMultiplyWith">scalarMultiplyWith</a></li><li data-type='method'><a href="module-bento_math_vector2.html#scale">scale</a></li><li data-type='method'><a href="module-bento_math_vector2.html#sqrMagnitude">sqrMagnitude</a></li><li data-type='method'><a href="module-bento_math_vector2.html#subtract">subtract</a></li><li data-type='method'><a href="module-bento_math_vector2.html#subtractFrom">subtractFrom</a></li><li data-type='method'><a href="module-bento_math_vector2.html#.copyInto">copyInto</a></li><li data-type='method'><a href="module-bento_math_vector2.html#.fromRotation">fromRotation</a></li></ul></details></li><li><details><summary>bento/objectpool</summary><a href="module-bento_objectpool.html">bento/objectpool</a><ul class='methods'><li data-type='method'><a href="module-bento_objectpool.html#~discard">discard</a></li><li data-type='method'><a href="module-bento_objectpool.html#~get">get</a></li></ul></details></li><li><details><summary>bento/packedimage</summary><a href="module-bento_packedimage.html">bento/packedimage</a></details></li><li><details><summary>bento/screen</summary><a href="module-bento_screen.html">bento/screen</a><ul class='methods'><li data-type='method'><a href="module-bento_screen.html#loadTiled">loadTiled</a></li><li data-type='method'><a href="module-bento_screen.html#onHide">onHide</a></li><li data-type='method'><a href="module-bento_screen.html#onShow">onShow</a></li></ul></details></li><li><details><summary>bento/sortedeventsystem</summary><a href="module-bento_sortedeventsystem.html">bento/sortedeventsystem</a><ul class='methods'><li data-type='method'><a href="module-bento_sortedeventsystem.html#off">off</a></li><li data-type='method'><a href="module-bento_sortedeventsystem.html#on">on</a></li></ul></details></li><li><details><summary>bento/tiled</summary><a href="module-bento_tiled.html">bento/tiled</a></details></li><li><details><summary>bento/tiledreader</summary><a href="module-bento_tiledreader.html">bento/tiledreader</a><ul class='methods'><li data-type='method'><a href="module-bento_tiledreader.html#read">read</a></li></ul></details></li><li><details><summary>bento/tween</summary><a href="module-bento_tween.html">bento/tween</a><ul class='methods'><li data-type='method'><a href="module-bento_tween.html#begin">begin</a></li><li data-type='method'><a href="module-bento_tween.html#pause">pause</a></li><li data-type='method'><a href="module-bento_tween.html#removeSelf">removeSelf</a></li><li data-type='method'><a href="module-bento_tween.html#resume">resume</a></li><li data-type='method'><a href="module-bento_tween.html#stop">stop</a></li></ul></details></li><li><details><summary>bento/utils</summary><a href="module-bento_utils.html">bento/utils</a><ul class='methods'><li data-type='method'><a href="module-bento_utils.html#approach">approach</a></li><li data-type='method'><a href="module-bento_utils.html#checksum">checksum</a></li><li data-type='method'><a href="module-bento_utils.html#clamp">clamp</a></li><li data-type='method'><a href="module-bento_utils.html#cloneJson">cloneJson</a></li><li data-type='method'><a href="module-bento_utils.html#copyObject">copyObject</a></li><li data-type='method'><a href="module-bento_utils.html#extend">extend</a></li><li data-type='method'><a href="module-bento_utils.html#forEach">forEach</a></li><li data-type='method'><a href="module-bento_utils.html#getDefault">getDefault</a></li><li data-type='method'><a href="module-bento_utils.html#getKeyLength">getKeyLength</a></li><li data-type='method'><a href="module-bento_utils.html#getRandom">getRandom</a></li><li data-type='method'><a href="module-bento_utils.html#getRandomFloat">getRandomFloat</a></li><li data-type='method'><a href="module-bento_utils.html#getRandomRange">getRandomRange</a></li><li data-type='method'><a href="module-bento_utils.html#getRandomRangeFloat">getRandomRangeFloat</a></li><li data-type='method'><a href="module-bento_utils.html#getScreenSize">getScreenSize</a></li><li data-type='method'><a href="module-bento_utils.html#isAmazonDevice">isAmazonDevice</a></li><li data-type='method'><a href="module-bento_utils.html#isAndroid">isAndroid</a></li><li data-type='method'><a href="module-bento_utils.html#isAndroidDevice">isAndroidDevice</a></li><li data-type='method'><a href="module-bento_utils.html#isApple">isApple</a></li><li data-type='method'><a href="module-bento_utils.html#isArray">isArray</a></li><li data-type='method'><a href="module-bento_utils.html#isBetween">isBetween</a></li><li data-type='method'><a href="module-bento_utils.html#isBoolean">isBoolean</a></li><li data-type='method'><a href="module-bento_utils.html#isCocoonJs">isCocoonJs</a></li><li data-type='method'><a href="module-bento_utils.html#isDefined">isDefined</a></li><li data-type='method'><a href="module-bento_utils.html#isDev">isDev</a></li><li data-type='method'><a href="module-bento_utils.html#isEmpty">isEmpty</a></li><li data-type='method'><a href="module-bento_utils.html#isFunction">isFunction</a></li><li data-type='method'><a href="module-bento_utils.html#isInt">isInt</a></li><li data-type='method'><a href="module-bento_utils.html#isIosDevice">isIosDevice</a></li><li data-type='method'><a href="module-bento_utils.html#isMobileBrowser">isMobileBrowser</a></li><li data-type='method'><a href="module-bento_utils.html#isNativeAndroid">isNativeAndroid</a></li><li data-type='method'><a href="module-bento_utils.html#isNativeIos">isNativeIos</a></li><li data-type='method'><a href="module-bento_utils.html#isNotEmpty">isNotEmpty</a></li><li data-type='method'><a href="module-bento_utils.html#isNumber">isNumber</a></li><li data-type='method'><a href="module-bento_utils.html#isObject">isObject</a></li><li data-type='method'><a href="module-bento_utils.html#isString">isString</a></li><li data-type='method'><a href="module-bento_utils.html#isUndefined">isUndefined</a></li><li data-type='method'><a href="module-bento_utils.html#log">log</a></li><li data-type='method'><a href="module-bento_utils.html#modulo">modulo</a></li><li data-type='method'><a href="module-bento_utils.html#pickRandom">pickRandom</a></li><li data-type='method'><a href="module-bento_utils.html#pickRandomFrom">pickRandomFrom</a></li><li data-type='method'><a href="module-bento_utils.html#removeFromArray">removeFromArray</a></li><li data-type='method'><a href="module-bento_utils.html#repeat">repeat</a></li><li data-type='method'><a href="module-bento_utils.html#setDev">setDev</a></li><li data-type='method'><a href="module-bento_utils.html#sign">sign</a></li><li data-type='method'><a href="module-bento_utils.html#toDegree">toDegree</a></li><li data-type='method'><a href="module-bento_utils.html#toRadian">toRadian</a></li></ul></details></li></ul><h3>Global</h3><ul><li><a href="global.html#bento">bento</a></li><li><a href="global.html">bento define</a></li><li><a href="global.html">bento require</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">managers/asset.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Manager that loads and controls assets. Can be accessed through Bento.assets namespace.
 * Assets MUST be loaded through assetGroups (for now). An assetgroup is a json file that indicates which
 * assets to load, and where to find them.
 * &lt;br>Exports: Constructor, can be accessed through Bento.assets namespace
 * @module bento/managers/asset
 * @moduleName AssetManager
 * @returns AssetManager
 */
bento.define('bento/managers/asset', [
    'bento/eventsystem',
    'bento/packedimage',
    'bento/utils',
    'audia',
    'lzstring'
], function (
    EventSystem,
    PackedImage,
    Utils,
    Audia,
    LZString
) {
    'use strict';
    return function (settings) {
        var useQueries = settings.useQueries; // placing queries avoids cached http requests
        var autoDisposeTextures = settings.autoDisposeTextures;
        var now = Date.now();
        var assetGroups = {};
        var loadedGroups = {};
        var path = '';
        var assets = {
            audio: {},
            json: {},
            images: {},
            binary: {},
            fonts: {},
            spritesheets: {},
            texturePacker: {},
            spine: {},

            // packed
            'packed-images': {},
            'packed-spritesheets': {},
            'packed-json': {}
        };
        var spineAssetLoader;
        var tempSpineImage;
        /**
         * (Down)Load asset types
         */
        var loadAudio = function (name, sources, callback) {
            var i, l;
            var failed = true;
            var lastSrc;
            var loadAudioFile = function (index, src) {
                var audio = new Audia();
                // get type by checking extension name
                var canPlay = audio.canPlayType('audio/' + src.slice(-3));

                if (src.indexOf('data:') === 0) {
                    // base64 data of audio
                    canPlay = true;
                }

                if (!!canPlay || window.ejecta) {
                    // success!
                    if (!manager.skipAudioCallback) {
                        audio.onload = function () {
                            callback(null, name, audio);
                        };
                    } else {
                        // callback immediately
                        window.setTimeout(function () {
                            callback(null, name, audio);
                        }, 0);
                    }
                    if (src.indexOf('http') === 0) {
                        audio.crossOrigin = 'Anonymous';
                    }
                    audio.src = src + (useQueries ? '?t=' + now : '');
                    failed = false;
                    return true;
                }
                if (!canPlay) {
                    lastSrc = src;
                }
                return false;
            };
            if (!Utils.isArray(sources)) {
                sources = [sources];
            }
            // try every type
            for (i = 0, l = sources.length; i &lt; l; ++i) {
                if (loadAudioFile(i, sources[i])) {
                    // we only care about one of the audio types working
                    break;
                }
            }
            if (failed) {
                callback('This audio type is not supported:' + name + lastSrc);
            }
        };
        var loadJSON = function (name, source, callback, isCompressed) {
            var xhr;
            var parseJson = function (jsonText) {
                var jsonData;
                try {
                    // read header
                    if (jsonText[0] === 'L' &amp;&amp; jsonText[1] === 'Z' &amp;&amp; jsonText[2] === 'S') {
                        isCompressed = true;
                        // trim header
                        jsonText = jsonText.substring(3);
                    }

                    if (isCompressed) {
                        // decompress if needed
                        jsonData = JSON.parse(LZString.decompressFromBase64(jsonText));
                    } else {
                        jsonData = JSON.parse(jsonText);
                    }
                } catch (e) {
                    console.log('WARNING: Could not parse JSON ' + name + ' at ' + source + ': ' + e);
                    console.log('Trying to parse', jsonText);
                    jsonData = jsonText;
                }
                callback(null, name, jsonData);
            };

            // source is a base64 string -> parse immediately instead of doing the xhr request
            if (source.indexOf('data:application/json;base64,') === 0) {
                if (window.decodeB64) {
                    parseJson(window.decodeB64(source.replace('data:application/json;base64,', '')));
                } else {
                    parseJson(window.atob(source.replace('data:application/json;base64,', '')));
                }
                return;
            } else if (source.indexOf('LZS') === 0) {
                parseJson(source);
                return;
            }

            xhr = new window.XMLHttpRequest();
            if (xhr.overrideMimeType) {
                xhr.overrideMimeType('application/json');
            }

            xhr.open('GET', source + (useQueries ? '?t=' + now : ''), true);
            xhr.onerror = function () {
                callback('Error: loading JSON ' + source);
            };
            xhr.ontimeout = function () {
                callback('Timeout: loading JSON ' + source);
            };
            xhr.onreadystatechange = function () {
                var response;
                if (xhr.readyState === 4) {
                    if ((xhr.status === 304) || (xhr.status === 200) || ((xhr.status === 0) &amp;&amp; xhr.responseText)) {
                        response = xhr.responseText;
                        parseJson(response);
                    } else {
                        callback('Error: State ' + xhr.readyState + ' ' + source);
                    }
                }
            };
            xhr.send(null);
        };
        var loadJsonCompressed = function (name, source, callback) {
            return loadJSON(name, source, callback, true);
        };
        var loadBinary = function (name, source, success, failure) {
            var xhr = new window.XMLHttpRequest();
            var arrayBuffer;
            var byteArray;
            var buffer;
            var i = 0;

            xhr.open('GET', source + (useQueries ? '?t=' + now : ''), true);
            xhr.onerror = function () {
                failure('ERROR: loading binary ' + source);
            };
            xhr.responseType = 'arraybuffer';
            xhr.onload = function (e) {
                var binary;
                arrayBuffer = xhr.response;
                if (arrayBuffer) {
                    byteArray = new Uint8Array(arrayBuffer);
                    buffer = [];
                    for (i; i &lt; byteArray.byteLength; ++i) {
                        buffer[i] = String.fromCharCode(byteArray[i]);
                    }
                    // loadedAssets.binary[name] = buffer.join('');
                    binary = buffer.join('');
                    success(null, name, binary);
                }
            };
            xhr.send();
        };
        var loadImage = function (name, source, callback) {
            var img = new Image();
            img._dispose = img.dispose; // backup original if it exists
            img.dispose = function () {
                // cocoon
                if (img._dispose) {
                    img._dispose();
                }
                // pixi
                if (img.texture &amp;&amp; img.texture.destroy) {
                    img.texture.destroy();
                }
            };

            // cocoon lazy load, might be useful some day?
            // img.cocoonLazyLoad = true;

            img.addEventListener('load', function () {
                callback(null, name, img);
            }, false);
            img.addEventListener('error', function (evt) {
                // TODO: Implement failure: should it retry to load the image?
                Utils.log('ERROR: loading image ' + source);
            }, false);

            if (source.indexOf('http') === 0) {
                img.crossOrigin = "Anonymous";
            }

            img.src = source + (useQueries ? '?t=' + now : '');
        };
        var loadTTF = function (name, source, callback) {
            // for every font to load we measure the width on a canvas
            var splitName = name;
            var canvas = document.createElement('canvas');
            var context = canvas.getContext('2d');
            var width = 0;
            var oldWidth;
            var intervalId;
            var checkCount = 0;
            var measure = function () {
                width = context.measureText('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890.,').width;
                return width;
            };
            var loadFont = function () {
                // append a style element with the font face
                // this method works with Canvas+
                var style = document.createElement('style');
                style.setAttribute("type", "text/css");
                style.innerHTML = "@font-face { font-family: '" + name +
                    "'; src: url('" + source + "');}";

                document.body.appendChild(style);

                // try setting it
                context.font = "normal 16px " + name;
            };
            // detect a loaded font by checking if the width changed
            var isLoaded = function () {
                return oldWidth !== measure();
            };

            // unlike other assets, the font name is not allowed to have slashes!
            if (name.indexOf("/") >= 0) {
                splitName = name.split("/");
                // swap name with last word
                name = splitName[splitName.length - 1];
            }

            loadFont();

            // measure for the first time
            oldWidth = measure();

            // check every 100ms
            intervalId = window.setInterval(function () {
                if (isLoaded()) {
                    // done!
                    window.clearInterval(intervalId);
                    if (callback) {
                        callback(null, name, name);
                    }
                } else if (checkCount >= 10) {
                    // give up after 1000ms
                    // possible scenarios:
                    // * a mistake was made, for example a typo in the path, and the font was never loaded
                    // * the font was already loaded (can happen in reloading in Cocoon devapp)
                    // either way we continue as if nothing happened, not loading the font shouldn't crash the game
                    window.clearInterval(intervalId);
                    console.log('Warning: font "' + name + '" timed out with loading.');
                    if (callback) {
                        callback(null, name, name);
                    }
                }
                checkCount += 1;
            }, 100);
        };
        var loadSpriteSheet = function (name, source, callback) {
            var spriteSheet = {
                image: null,
                animation: null
            };

            var checkForCompletion = function () {
                if (spriteSheet.image !== null &amp;&amp; spriteSheet.animation !== null) {
                    callback(null, name, spriteSheet);
                }
            };
            var sourceJson;
            var sourcePng;

            // source can be an object with 2 base64 strings
            if (source.json) {
                sourceJson = source.json;
                sourcePng = source.png;
            } else {
                sourceJson = source + '.json';
                sourcePng = source + '.png';
            }

            loadJSON(name, sourceJson, function (err, name, json) {
                if (err) {
                    callback(err, name, null);
                    return;
                }
                spriteSheet.animation = json;
                checkForCompletion();
            });

            loadImage(name, sourcePng, function (err, name, img) {
                if (err) {
                    callback(err, name, null);
                    return;
                }
                spriteSheet.image = PackedImage(img);
                checkForCompletion();
            });
        };
        var loadPackedImage = function (name, source, callback) {
            // very similar to spritesheet: load an image and load a json
            var packedImage = {
                image: null,
                data: null
            };
            var checkForCompletion = function () {
                if (packedImage.image !== null &amp;&amp; packedImage.data !== null) {
                    callback(null, name, packedImage);
                }
            };
            var sourceJson;
            var sourcePng;

            // source can be an object with 2 base64 strings
            if (source.json) {
                sourceJson = source.json;
                sourcePng = source.png;
            } else {
                sourceJson = source + '.json';
                sourcePng = source + '.png';
            }

            loadJSON(name, sourceJson, function (err, name, json) {
                if (err) {
                    callback(err, name, null);
                    return;
                }
                packedImage.data = json;
                checkForCompletion();
            });
            loadImage(name, sourcePng, function (err, name, img) {
                if (err) {
                    callback(err, name, null);
                    return;
                }
                packedImage.image = img;
                checkForCompletion();
            });
        };
        var loadSpriteSheetPack = function (name, source, callback) {
            var spriteSheet = {
                image: null,
                data: null
            };

            var checkForCompletion = function () {
                if (spriteSheet.image !== null &amp;&amp; spriteSheet.data !== null) {
                    callback(null, name, spriteSheet);
                }
            };
            var sourceJson;
            var sourcePng;

            // source can be an object with 2 base64 strings
            if (source.json) {
                sourceJson = source.json;
                sourcePng = source.png;
            } else {
                sourceJson = source + '.json';
                sourcePng = source + '.png';
            }

            loadJSON(name, sourceJson, function (err, name, json) {
                if (err) {
                    callback(err, name, null);
                    return;
                }
                spriteSheet.data = json;
                checkForCompletion();
            });

            loadImage(name, sourcePng, function (err, name, img) {
                if (err) {
                    callback(err, name, null);
                    return;
                }
                spriteSheet.image = img;
                checkForCompletion();
            });
        };
        var loadSpine = function (name, source, callback) {
            var path = (function () {
                // remove the final part
                var paths = source.split('/');
                paths.splice(-1, 1);
                return paths.join('/') + '/';
            })();
            var spine = {
                skeleton: null,
                atlas: null,
                images: [], // {img: Image, path: ''}
                imageCount: 0, // only used to check if all images are loaded
                skinImages: {}, // imageName -> skinName
                path: path,
                pathJson: source + ".json", // need this when removing asset
                pathAtlas: source + ".atlas", // need this when removing asset
                dispose: function () {
                    var i, l;
                    for (i = 0, l = spine.images.length; i &lt; l; ++i) {
                        spineAssetLoader.remove(spine.images[i].path);
                    }
                    spineAssetLoader.remove(spine.pathJson);
                    spineAssetLoader.remove(spine.pathAtlas);
                }
            };
            var checkForCompletion = function () {
                if (
                    spine.imageCount === spine.images.length &amp;&amp;
                    spine.skeleton !== null &amp;&amp;
                    spine.atlas !== null
                ) {
                    callback(null, name, spine);
                }
            };
            var onLoadSpineJson = function (path, data) {
                spine.skeleton = data;
                checkForCompletion();

                // next: load atlas
                spineAssetLoader.loadText(
                    source.replace("-pro", "").replace("-ess", "") + ".atlas",
                    function (path, dataAtlas) {
                        // it is in my belief that spine exports either the atlas or json wrong when skins are involved
                        // the atlas path becomes an relative path to the root as opposed to relative to images/
                        var skeletonJson = JSON.parse(data);
                        var prefix = skeletonJson.skeleton.images || '';
                        prefix = prefix.replace('./', '');
                        while (prefix &amp;&amp; dataAtlas.indexOf(prefix) >= 0) {
                            dataAtlas = dataAtlas.replace(prefix, '');
                        }
                        onLoadSpineAtlas(path, dataAtlas);
                    },
                    function (path, err) {
                        callback(err, name, null);
                    }
                );
            };
            var onLoadSpineAtlas = function (path, data) {
                // parse the atlas just to check what images to load
                var textureAtlas = new window.spine.TextureAtlas(data, function (path) {
                    // return a fake texture
                    if (!tempSpineImage) {
                        tempSpineImage = new Image();
                    }
                    return new window.spine.FakeTexture(tempSpineImage);
                });
                var pages = textureAtlas.pages;
                var i, l;

                // update image count
                spine.imageCount = pages.length;

                // load all the images
                if (!manager.lazyLoadSpine) {
                    for (i = 0, l = pages.length; i &lt; l; ++i) {
                        spineAssetLoader.loadTexture(
                            spine.path + pages[i].name,
                            onLoadSpineImage,
                            function (path, err) {
                                callback(err, name, null);
                            }
                        );
                    }
                } else {
                    // in case of lazy loading: Bento asset manager will not manage the spine images!
                    spine.imageCount = 0;

                    // we will now inspect the texture atlas and match skins with images
                    // which allows us to lazy load images per skin
                    // requirement: one image must match one skin! see this forum post http://esotericsoftware.com/forum/Separated-atlas-for-each-skin-9835?p=45504#p45504
                    linkSkinWithImage(textureAtlas);
                }

                spine.atlas = data;
                checkForCompletion();
            };
            var onLoadSpineImage = function (path, image) {
                spine.images.push({
                    img: image,
                    path: path
                });
                checkForCompletion();
            };
            var linkSkinWithImage = function (textureAtlas) {
                // In order for the lazy loading to work, we need to know 
                // what skin is related to which image. Spine will not do this out of the box
                // so we will have to parse the skeleton json and atlas manually and make
                // think link ourselves.
                var skeletonJson = JSON.parse(spine.skeleton);
                var skins = skeletonJson.skins;
                var findRegion = function (name) {
                    // searches region for a name and returns the page name
                    var i, l;
                    var region;
                    var regions = textureAtlas.regions;
                    for (i = 0, l = regions.length; i &lt; l; ++i) {
                        region = regions[i];
                        if (region.name === name) {
                            return region.page.name;
                        }
                    }
                    return '';
                };
                Utils.forEach(skins, function (skinData, skinName) {
                    Utils.forEach(skinData, function (slotData, slotName, l, breakLoop) {
                        Utils.forEach(slotData, function (attachmentData, attachmentName) {
                            var actualAttachmentName = attachmentData.name;
                            // we link the name with a region in the atlas data
                            var pageName;

                            if (!actualAttachmentName) {
                                // attachment name does not exist, just assign to the first page??
                                pageName = textureAtlas.pages[0].name;
                            } else {
                                pageName = findRegion(actualAttachmentName);
                            }

                            // once found, we break the slots loop
                            if (pageName) {
                                breakLoop();
                                spine.skinImages[pageName] = skinName;
                            }
                        });
                    });
                });
            };

            // to load spine, you must include spine-canvas.js
            if (!window.spine) {
                console.error("ERROR: spine library not found!");
                callback("Loading spine failed.");
                return;
            }
            // note: we could in the future implement the asset loading with bento
            // but for convenience sake we simply use the spine asset manager for now
            if (!spineAssetLoader) {
                spineAssetLoader = new window.spine.canvas.AssetManager();
            }

            spineAssetLoader.loadText(
                spine.pathJson,
                onLoadSpineJson, // will load atlas here
                function (path, err) {
                    callback(err, name, null);
                }
            );
        };
        /**
         * Loads asset groups (json files containing names and asset paths to load)
         * If the assetGroup parameter is passed to Bento.setup, this function will be
         * called automatically by Bento.
         * This will not load the assets (merely the assetgroups). To load the assets,
         * you must call Bento.assets.load()
         * @function
         * @instance
         * @param {Object} jsonFiles - Name with json path
         * @param {Function} onReady - Callback when ready
         * @param {Function} onLoaded - Callback when json file is loaded
         * @name loadAssetGroups
         */
        var loadAssetGroups = function (jsonFiles, onReady, onLoaded) {
            var jsonName;
            var keyCount = Utils.getKeyLength(jsonFiles);
            var loaded = 0;
            var callback = function (err, name, json) {
                if (err) {
                    Utils.log(err);
                    return;
                }
                assetGroups[name] = json;
                loaded += 1;
                if (Utils.isDefined(onLoaded)) {
                    onLoaded(loaded, keyCount, name, 'json');
                }
                if (keyCount === loaded &amp;&amp; Utils.isDefined(onReady)) {
                    onReady(null, 'assetGroup');
                }
            };
            for (jsonName in jsonFiles) {
                if (jsonFiles.hasOwnProperty(jsonName)) {
                    loadJSON(jsonName, jsonFiles[jsonName], callback);
                }
            }
        };
        /**
         * Loads assets from asset group.
         * @function
         * @instance
         * @param {String} groupName - Name of asset group
         * @param {Function} onReady - Callback when ready
         * @param {Function} onLoaded - Callback when asset file is loaded
         * @param {Bool} skipPackedImages - do not initialize texture packed images
         * @name load
         */
        var load = function (groupName, onReady, onLoaded) {
            var group = assetGroups[groupName];
            var asset;
            var assetsLoaded = 0;
            var assetCount = 0;
            var toLoad = [];
            // assets to unpack
            var toUnpack = {
                'packed-images': {},
                'packed-spritesheets': {},
                'packed-json': {}
            };
            var packs = [];
            var postLoad = function () {
                var initPackedImagesLegacy = function () {
                    // old way of packed images
                    var frame, pack, i, l, image, json, name;
                    while (packs.length) {
                        pack = packs.pop();
                        image = getImageElement(pack);
                        json = getJson(pack);

                        if (!image || !json) {
                            // TODO: should have a cleaner method to check if packs are not loaded yet
                            // return the pack until the image/json is loaded
                            packs.push(pack);
                            return;
                        }

                        // parse json
                        for (i = 0, l = json.frames.length; i &lt; l; ++i) {
                            name = json.frames[i].filename;
                            name = name.substring(0, name.length - 4);
                            frame = json.frames[i].frame;
                            assets.texturePacker[name] = new PackedImage(image, frame);
                        }
                    }
                };
                var initPackedImages = function () {
                    // expand into images
                    var packedImages = toUnpack['packed-images'];
                    Utils.forEach(packedImages, function (packData, name) {
                        var image = packData.image;
                        var data = packData.data;
                        Utils.forEach(data, function (textureData, i) {
                            // turn into image data
                            var assetName = textureData.assetName;
                            var frame = {
                                x: textureData.x,
                                y: textureData.y,
                                w: textureData.width,
                                h: textureData.height,
                            };
                            assets.texturePacker[assetName] = new PackedImage(image, frame);
                        });
                    });
                };
                var unpackJson = function () {
                    // unpack json into multiple jsons
                    var key;
                    var packedJson = toUnpack['packed-json'];
                    Utils.forEach(packedJson, function (group) {
                        Utils.forEach(group, function (json, key, l, breakLoop) {
                            assets.json[key] = json;
                        });
                    });
                };
                var unpackSpriteSheets = function () {
                    // expand into images
                    var packedImages = toUnpack['packed-spritesheets'];
                    Utils.forEach(packedImages, function (packData, name) {
                        var image = packData.image;
                        var data = packData.data;
                        Utils.forEach(data, function (textureData, i) {
                            // turn into image data
                            var assetName = textureData.assetName;
                            var frame = {
                                x: textureData.x,
                                y: textureData.y,
                                w: textureData.width,
                                h: textureData.height,
                            };
                            var spriteSheet = {
                                image: new PackedImage(image, frame),
                                animation: textureData.spriteSheet
                            };
                            assets.spritesheets[assetName] = spriteSheet;
                        });
                    });
                };
                // after everything has loaded, do some post processing
                initPackedImagesLegacy();
                initPackedImages();
                unpackJson();
                unpackSpriteSheets();
                // mark as loaded
                loadedGroups[groupName] = true;
                // callback
                if (Utils.isDefined(onReady)) {
                    onReady(null, groupName);
                }
            };
            var checkLoaded = function () {
                if (assetCount === 0 || (assetCount > 0 &amp;&amp; assetsLoaded === assetCount)) {
                    postLoad();
                }
            };
            var onLoadImage = function (err, name, image) {
                if (err) {
                    Utils.log(err);
                    return;
                }
                assets.images[name] = image;
                assetsLoaded += 1;
                if (Utils.isDefined(onLoaded)) {
                    onLoaded(assetsLoaded, assetCount, name, 'image');
                }
                checkLoaded();
            };
            // DEPRECATED
            var onLoadPack = function (err, name, json) {
                // TODO: fix texturepacker loading
                if (err) {
                    Utils.log(err);
                    return;
                }
                assets.json[name] = json;
                packs.push(name);
                assetsLoaded += 1;
                if (Utils.isDefined(onLoaded)) {
                    onLoaded(assetsLoaded, assetCount, name, 'pack');
                }
                checkLoaded();
            };
            var onLoadJson = function (err, name, json) {
                if (err) {
                    Utils.log(err);
                    return;
                }
                assets.json[name] = json;
                assetsLoaded += 1;
                if (Utils.isDefined(onLoaded)) {
                    onLoaded(assetsLoaded, assetCount, name, 'json');
                }
                checkLoaded();
            };
            var onLoadTTF = function (err, name, ttf) {
                if (err) {
                    Utils.log(err);
                    return;
                }
                assets.fonts[name] = ttf;
                assetsLoaded += 1;
                if (Utils.isDefined(onLoaded)) {
                    onLoaded(assetsLoaded, assetCount, name, 'ttf');
                }
                checkLoaded();
            };
            var onLoadAudio = function (err, name, audio) {
                if (err) {
                    Utils.log(err);
                } else {
                    assets.audio[name] = audio;
                }
                assetsLoaded += 1;
                if (Utils.isDefined(onLoaded)) {
                    onLoaded(assetsLoaded, assetCount, name, 'audio');
                }
                checkLoaded();
            };
            var onLoadSpriteSheet = function (err, name, spriteSheet) {
                if (err) {
                    Utils.log(err);
                } else {
                    assets.spritesheets[name] = spriteSheet;
                }
                assetsLoaded += 1;
                if (Utils.isDefined(onLoaded)) {
                    onLoaded(assetsLoaded, assetCount, name, 'spriteSheet');
                }
                checkLoaded();
            };
            var onLoadSpine = function (err, name, spine) {
                if (err) {
                    Utils.log(err);
                } else {
                    assets.spine[name] = spine;
                }
                assetsLoaded += 1;
                if (Utils.isDefined(onLoaded)) {
                    onLoaded(assetsLoaded, assetCount, name, 'spine');
                }
                checkLoaded();
            };
            // packs
            var onLoadImagePack = function (err, name, imagePack) {
                if (err) {
                    Utils.log(err);
                    return;
                }
                assets['packed-images'][name] = imagePack;
                toUnpack['packed-images'][name] = imagePack;
                assetsLoaded += 1;
                if (Utils.isDefined(onLoaded)) {
                    onLoaded(assetsLoaded, assetCount, name, 'imagePack');
                }
                checkLoaded();
            };
            var onLoadJsonPack = function (err, name, json) {
                if (err) {
                    console.log(err);
                    return;
                }
                assets['packed-json'][name] = json;
                toUnpack['packed-json'][name] = json;
                assetsLoaded += 1;
                if (Utils.isDefined(onLoaded)) {
                    onLoaded(assetsLoaded, assetCount, name, 'jsonPack');
                }
                checkLoaded();
            };
            var onLoadSpriteSheetPack = function (err, name, spriteSheetPack) {
                if (err) {
                    Utils.log(err);
                    return;
                }
                assets['packed-spritesheets'][name] = spriteSheetPack;
                toUnpack['packed-spritesheets'][name] = spriteSheetPack;
                assetsLoaded += 1;
                if (Utils.isDefined(onLoaded)) {
                    onLoaded(assetsLoaded, assetCount, name, 'spriteSheetPack');
                }
                checkLoaded();
            };

            var readyForLoading = function (fn, asset, path, callback) {
                toLoad.push({
                    fn: fn,
                    asset: asset,
                    path: path,
                    callback: callback
                });
            };
            var loadAllAssets = function () {
                var i = 0,
                    l;
                var data;
                for (i = 0, l = toLoad.length; i &lt; l; ++i) {
                    data = toLoad[i];
                    data.fn(data.asset, data.path, data.callback);
                }
                if (toLoad.length === 0) {
                    checkLoaded();
                }
            };

            if (!Utils.isDefined(group)) {
                onReady('Could not find asset group ' + groupName);
                return;
            }
            // set path
            if (Utils.isDefined(group.path)) {
                path = group.path;
            }
            // count the number of assets first
            // get images
            if (Utils.isDefined(group.images)) {
                assetCount += Utils.getKeyLength(group.images);
                for (asset in group.images) {
                    if (!group.images.hasOwnProperty(asset)) {
                        continue;
                    }
                    readyForLoading(loadImage, asset, path === 'base64' ? group.images[asset] : path + 'images/' + group.images[asset], onLoadImage);
                }
            }
            // get packed images
            if (Utils.isDefined(group.texturePacker)) {
                assetCount += Utils.getKeyLength(group.texturePacker);
                for (asset in group.texturePacker) {
                    if (!group.texturePacker.hasOwnProperty(asset)) {
                        continue;
                    }
                    readyForLoading(loadJSON, asset, path === 'base64' ? group.texturePacker[asset] : path + 'json/' + group.texturePacker[asset], onLoadPack);
                }
            }
            // get audio
            if (Utils.isDefined(group.audio)) {
                assetCount += Utils.getKeyLength(group.audio);
                Utils.forEach(group.audio, function (asset, key, l, breakLoop) {
                    // concat path on array
                    var src = [];
                    // asset can be a single string or array of strings
                    if (!Utils.isArray(asset)) {
                        asset = [asset];
                    }
                    Utils.forEach(asset, function (audioSrc) {
                        src.push(path === 'base64' ? audioSrc : path + 'audio/' + audioSrc);
                    });

                    readyForLoading(loadAudio, key, src, onLoadAudio);
                });
            }
            // get json
            if (Utils.isDefined(group.json)) {
                assetCount += Utils.getKeyLength(group.json);
                for (asset in group.json) {
                    if (!group.json.hasOwnProperty(asset)) {
                        continue;
                    }
                    readyForLoading(loadJSON, asset, path === 'base64' ? group.json[asset] : path + 'json/' + group.json[asset], onLoadJson);
                }
            }
            // get fonts
            if (Utils.isDefined(group.fonts)) {
                assetCount += Utils.getKeyLength(group.fonts);
                for (asset in group.fonts) {
                    if (!group.fonts.hasOwnProperty(asset)) {
                        continue;
                    }
                    readyForLoading(loadTTF, asset, path === 'base64' ? group.fonts[asset] : path + 'fonts/' + group.fonts[asset], onLoadTTF);
                }
            }
            // get spritesheets
            if (Utils.isDefined(group.spritesheets)) {
                assetCount += Utils.getKeyLength(group.spritesheets);
                for (asset in group.spritesheets) {
                    if (!group.spritesheets.hasOwnProperty(asset)) {
                        continue;
                    }
                    readyForLoading(loadSpriteSheet, asset, path === 'base64' ? group.spritesheets[asset] : path + 'spritesheets/' + group.spritesheets[asset], onLoadSpriteSheet);
                }
            }
            // get spine
            if (Utils.isDefined(group.spine)) {
                assetCount += Utils.getKeyLength(group.spine);
                for (asset in group.spine) {
                    if (!group.spine.hasOwnProperty(asset)) {
                        continue;
                    }
                    readyForLoading(loadSpine, asset, path + 'spine/' + group.spine[asset], onLoadSpine);
                }
            }

            // packed assets
            if (Utils.isDefined(group['packed-images'])) {
                assetCount += Utils.getKeyLength(group['packed-images']);
                Utils.forEach(group['packed-images'], function (assetPath, assetName) {
                    readyForLoading(loadPackedImage, assetName, path === 'base64' ? assetPath : path + 'packed-images/' + assetPath, onLoadImagePack);
                });
            }
            // get (compressed) packed json
            if (Utils.isDefined(group['packed-json'])) {
                assetCount += Utils.getKeyLength(group['packed-json']);
                Utils.forEach(group['packed-json'], function (assetPath, assetName) {
                    readyForLoading(loadJSON, assetName, path === 'base64' ? assetPath : path + 'packed-json/' + assetPath, onLoadJsonPack);
                });
            }
            // get packed spritesheet
            if (Utils.isDefined(group['packed-spritesheets'])) {
                assetCount += Utils.getKeyLength(group['packed-spritesheets']);
                Utils.forEach(group['packed-spritesheets'], function (assetPath, assetName) {
                    readyForLoading(loadSpriteSheetPack, assetName, path === 'base64' ? assetPath : path + 'packed-spritesheets/' + assetPath, onLoadSpriteSheetPack);
                });
            }

            // load all assets
            loadAllAssets();

            return assetCount;
        };
        /**
         * Loads image from URL. The resulting asset can be accessed through Bento.assets.getImage().
         * @function
         * @instance
         * @param {String} name - Name of asset
         * @param {String} url - Url path (relative to your index.html)
         * @param {Function} callback - Callback function
         * @name loadImageFromUrl
         */
        var loadImageFromUrl = function (name, url, callback) {
            var onLoadImage = function (err, name, image) {
                if (err) {
                    Utils.log(err);
                    if (callback) {
                        callback(err);
                    }
                    return;
                }
                assets.images[name] = image;
                if (callback) {
                    callback(null, image);
                }
            };
            if (assets.images[name]) {
                // already exists
                if (callback) {
                    callback(null, assets.images[name]);
                }
                return;
            }
            loadImage(name, url, onLoadImage);
        };
        /**
         * Loads JSON from URL. The resulting asset can be accessed through Bento.assets.getJson().
         * @function
         * @instance
         * @param {String} name - Name of asset
         * @param {String} url - Url path (relative to your index.html)
         * @param {Function} callback - Callback function
         * @name loadJsonFromUrl
         */
        var loadJsonFromUrl = function (name, url, callback) {
            var onLoadJson = function (err, name, json) {
                if (err) {
                    Utils.log(err);
                    if (callback) {
                        callback(err);
                    }
                    return;
                }
                assets.json[name] = json;
                if (callback) {
                    callback(null, json);
                }
            };
            loadJSON(name, url, onLoadJson);
        };
        /**
         * Loads audio from URL. The resulting asset can be accessed through Bento.assets.getAudio().
         * @function
         * @instance
         * @param {String} name - Name of asset
         * @param {String} url - Url path (relative to your index.html)
         * @param {Function} callback - Callback function
         * @name loadAudioFromUrl
         */
        var loadAudioFromUrl = function (name, url, callback) {
            var onLoadAudio = function (err, name, audio) {
                if (err) {
                    Utils.log(err);
                    if (callback) {
                        callback(err);
                    }
                    return;
                }
                assets.audio[name] = audio;
                if (callback) {
                    callback(audio);
                }
            };
            loadAudio(name, url, onLoadAudio);
        };
        /**
         * Unloads assets
         * @function
         * @instance
         * @param {String} groupName - Name of asset group
         * @param {Boolean} dispose - Should use Canvas+ dispose
         * @name unload
         */
        var unload = function (groupName, dispose) {
            // find all assets in this group
            var assetGroup = assetGroups[groupName];
            
            dispose = Utils.getDefault(dispose, true);

            if (!assetGroup) {
                Utils.log('ERROR: asset group ' + groupName + ' does not exist');
                return;
            }

            Utils.forEach(assetGroup, function (group, type) {
                if (typeof group !== "object") {
                    return;
                }
                Utils.forEach(group, function (assetPath, name) {
                    // NOTE: from this point on there are a lot of manual checks etc.
                    // would be nicer to make unify the logic...

                    // find the corresponding asset from the assets object
                    var assetTypeGroup = assets[type] || {};
                    var asset = assetTypeGroup[name];
                    var removePackedImage = function (packedImages) {
                        // find what it unpacked to
                        var image = packedImages.image;
                        var data = packedImages.data;
                        Utils.forEach(data, function (textureData, i) {
                            // find out the asset name
                            var assetName = textureData.assetName;
                            var textureAsset = assets.texturePacker[assetName];
                            // delete if this asset still exists
                            if (textureAsset) {
                                delete assets.texturePacker[assetName];
                            }
                        });
                        // dispose if possible
                        if (dispose &amp;&amp; image.dispose) {
                            image.dispose();
                        }
                        if (dispose &amp;&amp; image.image &amp;&amp; image.image.dispose) {
                            image.image.dispose();
                        }
                    };
                    var removePackedSpriteSheet = function (packedSpriteSheets) {
                        // find what it unpacked to
                        var image = packedSpriteSheets.image;
                        var data = packedSpriteSheets.data;
                        Utils.forEach(data, function (textureData, i) {
                            // find out the asset name
                            var assetName = textureData.assetName;
                            var spriteSheet = assets.spritesheets[assetName];
                            // delete if this asset still exists
                            if (spriteSheet) {
                                delete assets.spritesheets[assetName];
                            }
                        });
                        // dispose if possible
                        if (dispose &amp;&amp; image.dispose) {
                            image.dispose();
                        }
                        if (dispose &amp;&amp; image.image &amp;&amp; image.image.dispose) {
                            image.image.dispose();
                        }
                    };
                    var removePackedJson = function (packedJson) {
                        // find what it unpacked to
                        Utils.forEach(packedJson, function (json, key, l, breakLoop) {
                            delete assets.json[key];
                        });
                    };

                    if (asset) {
                        // remove reference to it
                        assetTypeGroup[name] = undefined;
                        // delete could be bad for performance(?)
                        delete assetTypeGroup[name];

                        if (type === 'images') {
                            // also remove corresponding texturepacker
                            if (assets.texturePacker[name]) {
                                assets.texturePacker[name] = undefined;
                                delete assets.texturePacker[name];
                            }
                        } else if (type === 'packed-images') {
                            removePackedImage(asset);
                        } else if (type === 'packed-spritesheets') {
                            removePackedSpriteSheet(asset);
                        } else if (type === 'packed-json') {
                            removePackedJson(asset);
                        }

                        // Canvas+ only: dispose if possible
                        // https://blog.ludei.com/techniques-to-optimize-memory-use-in-ludeis-canvas-environment/
                        if (dispose) {
                            // image
                            if (asset.dispose) {
                                asset.dispose();
                            }
                            // spritesheet or spine
                            else if (asset.image &amp;&amp; asset.image.dispose) {
                                asset.image.dispose();
                            } else if (asset.image &amp;&amp; asset.image.image &amp;&amp; asset.image.image.dispose) {
                                asset.image.image.dispose();
                            }
                            // audia
                            else if (asset._audioNode &amp;&amp; asset._audioNode.dispose) {
                                asset._audioNode.dispose();
                            }
                        }
                    }
                });
            });
            // mark as unloaded
            loadedGroups[groupName] = false;
        };
        /**
         * Returns a previously loaded image
         * @function
         * @instance
         * @param {String} name - Name of image
         * @returns {PackedImage} Image
         * @name getImage
         */
        var getImage = function (name) {
            // NOTE: getImage always returns a PackedImage
            // if the loaded image has not been initialized as PackedImage yet,
            // getImage will do that now and caches the PackedImage in assets.texturePacker
            var image, packedImage = assets.texturePacker[name];
            if (!packedImage) {
                image = getImageElement(name);
                if (!image) {
                    Utils.log("ERROR: Image " + name + " could not be found");
                    return null;
                }
                packedImage = PackedImage(image);
                assets.texturePacker[name] = packedImage;
            }
            return packedImage;
        };
        /**
         * Returns a previously loaded image element
         * @function
         * @instance
         * @param {String} name - Name of image
         * @returns {HTMLImage} Html Image element
         * @name getImageElement
         */
        var getImageElement = function (name) {
            var asset = assets.images[name];
            if (!Utils.isDefined(asset)) {
                Utils.log("ERROR: ImageElement " + name + " could not be found");
            }
            return asset;
        };
        /**
         * Returns a previously loaded json object
         * @function
         * @instance
         * @param {String} name - Name of json file
         * @returns {Object} Json object
         * @name getJson
         */
        var getJson = function (name) {
            var asset = assets.json[name];
            if (!Utils.isDefined(asset)) {
                Utils.log("ERROR: JSON " + name + " could not be found");
            }
            return asset;
        };
        /**
         * Returns a previously loaded audio element (currently by howler)
         * @function
         * @instance
         * @param {String} name - Name of image
         * @returns {Audia} Audia object
         * @name getAudio
         */
        var getAudio = function (name) {
            var asset = assets.audio[name];
            if (!Utils.isDefined(asset)) {
                Utils.log("ERROR: Audio " + name + " could not be found");
            }
            return asset;
        };
        /**
         * Returns a previously loaded spriteSheet element
         * @function
         * @instance
         * @param {String} name - Name of spriteSheet
         * @returns {Object} spriteSheet object
         * @name getSpriteSheet
         */
        var getSpriteSheet = function (name) {
            var asset = assets.spritesheets[name];
            if (!Utils.isDefined(asset)) {
                Utils.log("ERROR: Sprite sheet " + name + " could not be found");
            }
            return asset;
        };
        /**
         * Returns a previously loaded Spine object
         * @function
         * @instance
         * @param {String} name - Name of Spine object
         * @returns {Object} Spine object
         * @name getSpine
         */
        var getSpine = function (name) {
            var asset = assets.spine[name];
            if (!Utils.isDefined(asset)) {
                Utils.log("ERROR: Spine object " + name + " could not be found");
            }
            return asset;
        };
        var getSpineLoader = function (name) {
            return spineAssetLoader;
        };
        /**
         * Returns all assets
         * @function
         * @instance
         * @param {String} name - Name of image
         * @returns {Object} assets - Object with reference to all loaded assets
         * @name getAssets
         */
        var getAssets = function () {
            return assets;
        };
        /**
         * Returns asset group
         * @function
         * @instance
         * @returns {Object} assetGroups - reference to loaded JSON file
         * @name getAssetGroups
         */
        var getAssetGroups = function () {
            return assetGroups;
        };
        /**
         * Reloads all previously loaded assets
         * @function
         * @instance
         * @param {Function} callback - called when all assets are loaded
         * @name reload
         */
        var reload = function (callback) {
            var group;
            var loaded = 0;
            var groupsToLoad = [];
            var loadGroups = function () {
                var i, l;
                for (i = 0, l = groupsToLoad.length; i &lt; l; ++i) {
                    load(groupsToLoad[i], end, function (current, total, name) {});
                }
            };
            var end = function () {
                loaded += 1;

                if (loaded === groupsToLoad.length &amp;&amp; callback) {
                    callback();
                }
            };
            // collect groups
            for (group in assetGroups) {
                if (!assetGroups.hasOwnProperty(group)) {
                    continue;
                }
                if (!loadedGroups[group]) {
                    // havent loaded this group yet
                    continue;
                }
                groupsToLoad.push(group);
            }

            // load them
            loadGroups();
        };
        /**
         * Attempts to load ./assets.json and interpret it as assetgroups
         * @function
         * @instance
         * @param {Function} onRead - Called with an error string or null if successful
         * @name loadAssetsJson
         */
        var loadAssetsJson = function (onReady) {
            loadJSON('assets.json', 'assets.json', function (error, name, assetsJson) {
                var isLoading = false;
                var groupsToLoad = {};
                if (error) {
                    onReady(error);
                    return;
                }
                // check the contents of json
                Utils.forEach(assetsJson, function (group, groupName, l, breakLoop) {
                    if (Utils.isString(group)) {
                        // assume assets.json consists of strings to load json files with
                        isLoading = true;
                        groupsToLoad[groupName] = group;
                    } else {
                        // the asset group is present
                        assetGroups[groupName] = group;
                    }
                });

                if (isLoading) {
                    // load jsons
                    loadAssetGroups(groupsToLoad, onReady);
                } else {
                    // done
                    onReady(null, 'assetsJson');
                }
            });
        };
        // undocumented feature: assets.json may be inlined as window.assetJson
        var loadInlineAssetsJson = function () {
            if (window.assetsJson) {
                if (Utils.isString(window.assetsJson)) {
                    // decompress first
                    window.assetsJson = JSON.parse(LZString.decompressFromBase64(window.assetsJson));
                }
                Utils.forEach(window.assetsJson, function (group, groupName) {
                    // the asset group is present
                    assetGroups[groupName] = group;
                });
            }
        };
        /**
         * Loads all assets
         * @function
         * @instance
         * @param {Object} settings
         * @param {Array} settings.exceptions - array of strings, which asset groups not to load
         * @param {Function} settings.onComplete - called when all assets are loaded
         * @param {Function} settings.onLoad - called on every asset loaded
         * @name reload
         */
        var loadAllAssets = function (settings) {
            var exceptions = settings.exceptions || [];
            var onReady = settings.onReady || settings.onComplete || function (err, name) {};
            var onLoaded = settings.onLoaded || settings.onLoad || function (count, total, name, type) {};
            var group;
            var groupName;
            var groupCount = 0;
            var assetCount = 0;
            var groupsLoaded = 0;
            var current = 0;
            // check if all groups loaded
            var end = function (err) {
                if (err) {
                    Utils.log(err);
                    return;
                }
                groupsLoaded += 1;
                if (groupsLoaded === groupCount &amp;&amp; onReady) {
                    onReady(null);
                }
            };
            // called on every asset
            var loadAsset = function (c, a, name, type) {
                current += 1;
                if (onLoaded) {
                    onLoaded(current, assetCount, name, type);
                }
            };
            // count groups before any loading
            for (groupName in assetGroups) {
                if (!assetGroups.hasOwnProperty(groupName)) {
                    continue;
                }
                if (exceptions.indexOf(groupName) >= 0) {
                    continue;
                }
                groupCount += 1;
            }

            // check every assetgroup and load its assets
            for (groupName in assetGroups) {
                if (!assetGroups.hasOwnProperty(groupName)) {
                    continue;
                }
                if (exceptions.indexOf(groupName) >= 0) {
                    continue;
                }
                group = assetGroups[groupName];
                assetCount += load(groupName, end, loadAsset);
            }

            // nothing to load
            if (groupCount === 0 &amp;&amp; onReady) {
                onReady();
            }
        };
        /**
         * Check if asset is loaded
         * @function
         * @instance
         * @param {String} name - name of asset
         * @param {String} [type] - type of asset (images, json, fonts, spritesheets etc). If omitted, all types will be searched
         * @return Boolean
         * @name hasAsset
         */
        var hasAsset = function (name, type) {
            var didFind = false;
            // fail when type doesnt exist
            if (type) {
                if (!assets[type]) {
                    // typo? (image vs images)
                    if (!assets[type + 's']) {
                        console.error('Asset type ' + type + " doesn't exist.");
                        return false;
                    } else {
                        console.log('WARNING: type should be ' + type + 's, not ' + type);
                        type = type + 's';
                    }
                }
                // check if asset exist
                if (assets[type][name]) {
                    return true;
                } else {
                    if (type === 'images') {
                        // images is a special case regarding packed textures
                        return hasAsset(name, 'texturePacker');
                    }
                }
            } else {
                // check all types
                Utils.forEach(assets, function (assetTypeGroup, assetType, l, breakLoop) {
                    if (assetTypeGroup[name]) {
                        didFind = true;
                        breakLoop();
                    }
                });
            }

            return didFind;
        };
        var manager = {
            lazyLoadSpine: false,
            skipAudioCallback: false,
            reload: reload,
            loadAllAssets: loadAllAssets,
            loadAssetGroups: loadAssetGroups,
            loadAssetsJson: loadAssetsJson,
            loadInlineAssetsJson: loadInlineAssetsJson,
            load: load,
            loadJson: loadJSON,
            loadImageFromUrl: loadImageFromUrl,
            loadJsonFromUrl: loadJsonFromUrl,
            loadAudioFromUrl: loadAudioFromUrl,
            unload: unload,
            getImage: getImage,
            getImageElement: getImageElement,
            getJson: getJson,
            getAudio: getAudio,
            getSpriteSheet: getSpriteSheet,
            getAssets: getAssets,
            getAssetGroups: getAssetGroups,
            hasAsset: hasAsset,
            getSpine: getSpine,
            getSpineLoader: getSpineLoader,
            forceHtml5Audio: function () {
                Audia = Audia.getHtmlAudia();
            }
        };

        // implement dispose for spine canvas texture(?)
        /*if (window.spine &amp;&amp; window.spine.canvas &amp;&amp; window.spine.canvas.CanvasTexture) {
            window.spine.canvas.CanvasTexture.prototype.dispose = function () {
                if (this._image &amp;&amp; this._image.dispose) {
                    this._image.dispose();
                }
            };
        }*/

        if (autoDisposeTextures) {
            // destroy webgl textures on every screen hide
            EventSystem.on('screenHidden', function () {
                Utils.forEach(assets.images, function (image) {
                    if (image &amp;&amp; image.texture &amp;&amp; image.texture.destroy) {
                        image.texture.destroy();
                    }
                });
            });
        }

        return manager;
    };
});</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
<script src="scripts/opennav.js"></script>
</body>
</html>
